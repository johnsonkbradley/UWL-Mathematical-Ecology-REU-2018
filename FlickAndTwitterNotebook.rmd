---
title: "R Notebook"
output: html_notebook
---

Libraries
===

```{r}
##pulling from api packages
library(rtweet)
library(httr)
library(jsonlite)
```

Load in the keys
===

```{r}
##flickr keys
keys <- read.table("flickrAPIkeys.txt", sep = ",", header = T) #have key and secret
##twitter keys
twitterKeys <- read.table("twitterAPIkeys.txt", sep = ",", header = T)
twitterKeys$consumer_key <- as.character(twitterKeys$consumer_key)
twitterKeys$consumer_secret <- as.character(twitterKeys$consumer_secret)
twitterKeys$access_token <- as.character(twitterKeys$access_token)
twitterKeys$access_secret <- as.character(twitterKeys$access_secret)
```

Flickr functions
===

```{r}
## This function will give you all of the flickr photos for a given query, starting from a certain date that the photos were taken
## Inputs: the search query you want, the earliest day you want to grab that a photo was taken on
## OUtputs: all flickr posts matching the qeury and the minimum photo taken date that you specified
GetPhotos <- function(query, startDate) {
  query <- gsub(" ", "+", query)
  startDate <- gsub("/", "%2F", startDate)
  url <- paste("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=",keys$key,"&text=",query,"&min_taken_date=",startDate,"&sort=date-taken-asc&content_type=1&per_page=5000&format=json&nojsoncallback=1&api_sig=",keys$secret, sep = "")
  photos <- GET(url = url)%>%content(as = "text")%>%fromJSON()
  photosDF <- photos$'photos'$photo
  return(photosDF)
}


## This function will give you all of the flickr photos for a given query, starting from a certain date that the photos were taken within a certain bounding box
## Inputs: the search query you want, the earliest day you want to grab that a photo was taken on, along with the bounding box of the area you want, comma seperated minlong, minlat, maxlong, maxlat
## OUtputs: all flickr posts matching the qeury and the minimum photo taken date that you specified
GetPhotosBBox <- function(query, startDate, bbox) {
  query <- gsub(" ", "+", query)
  startDate <- gsub("/", "%2F", startDate)
  url <- paste("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=",keys$key,"&text=",query,"&min_taken_date=",startDate,"&bbox=",bbox,"&sort=date-taken-asc&content_type=1&per_page=500&format=json&nojsoncallback=1&api_sig=",keys$secret, sep = "")
  photos <- GET(url = url)%>%content(as = "text")%>%fromJSON()
  photosDF <- photos$'photos'$photo
  return(photosDF)
}

## This function will return the date that a flickr photo was taken, given the id number of the picture
## Inputs: the id number of the picture you want to know the date taken
## Outputs: the date taken
GetDate <- function(id) {
  url <- paste("https://api.flickr.com/services/rest/?method=flickr.photos.getInfo&api_key=",keys$key,"&photo_id=",id,"&format=json&nojsoncallback=1&api_sig=",keys$secret, sep = "")
  info <- GET(url = url)%>%content(as = "text")%>%fromJSON()
  date <- info$`photo`$dates$taken
  return(date)
}

## This function will return the home location listed by each flickr user
## Inputs: user id
## Outputs: home location for the poster of the photo
GetHomeLocation <- function(user) {
  url <- paste("https://api.flickr.com/services/rest/?method=flickr.people.getInfo&api_key=",keys$key,"&user_id=",user,"&format=json&nojsoncallback=1&api_sig=",keys$secret, sep = "")
  info <- GET(url = url)%>%content(as = "text")%>%fromJSON()
  location <- info$`person`$location$`_content`
  return(location)
}

```

Setting up the Twitter Token (so we can use the API)
===

```{r}
create_token(app = "REU 2018", consumer_key = twitterKeys$consumer_key, consumer_secret =  twitterKeys$consumer_secret, access_token = twitterKeys$access_token, access_secret = twitterKeys$access_secret)
```

How to search using rtweets (test)
===

```{r}
mendota1 <- search_tweets(q = "Lake Mendota")
ts_plot(mendota1) ##we can see the number of tweets per time; ggplot style; 9 day cap for pulls
mendota1 ##this is saved as a list, so we cant save in a csv file to send save as an rda file


waubesa1 <- search_tweets(q = "Lake Waubesa")
ts_plot(waubesa1)
waubesa1

shawano1 <- search_tweets(q = "Shawano Lake")
ts_plot(shawano1)
shawano1

druid1 <- search_tweets(q = "Druid Lake")
ts_plot(druid1)
druid1

hatch1 <- search_tweets(q = "Hatch Lake")
ts_plot(hatch1)
hatch1

squash1 <- search_tweets(q = "Squash Lake")
ts_plot(squash1)
squash1

mcgee1 <- search_tweets(q = "McGee Lake")
ts_plot(mcgee1)
mcgee1

tabor1 <- search_tweets(q = "Tabor Lake")
ts_plot(tabor1)
tabor1

parker1 <- search_tweets(q = "Parker Lake") ## will have to search through to find the relevant ones
ts_plot(parker1)
parker1

shell1 <- search_tweets(q = "Shell Lake") ## will have to search through to find the relevant ones
shell1

koshkonong1 <- search_tweets(q = "Lake Koshkonong")
koshkonong1

ripley1 <- search_tweets(q = "Lake Ripley") ## will have to search through to find the relevant ones
ripley1

nagawicka1 <- search_tweets(q = "Nagawicka Lake")
nagawicka1

birch1 <- search_tweets(q = "Birch Lake")
birch1

##saving as an rda file
save(mendota1, file = "mendota6.20.2018.rda")
save(waubesa1, file = "waubesa6.26.2018.rda")
save(shawano1, file = "shawano6.26.2018.rda")
save(druid1, file = "druid6.26.2018.rda")
save(hatch1, file = "hatch6.26.2018.rda")
save(squash1, file = "squash.6.26.2018.rda")
save(mcgee1, file = "mcgee6.26.2018.rda")
save(tabor1, file = "tabor6.26.2018.rda")
save(parker1, file = "parker6.27.2018.rda")
save(shell1, file = "shell6.27.2018.rda")
save(koshkonong1, file = "koshkonong6.27.2018.rda")
save(ripley1, file = "ripley6.27.2018.rda")
save(nagawicka1, file = "nagawicka6.27.2018.rda")
save(birch1, file = "birch6.27.2018.rda")
save(mendota1, file = "mendota7.6.2018.rda")
```


Flickr function to get Visitors per year
===

```{r}
## This function will give us the average number of visitors per year based on a data frame of flickr photos
## Inputs: a data frame of flickr photos
## Outputs: the number of visitors per year for a lake
FlickrVPY <- function(dataFlickr5) {
  dataFlickr5$Year <- substr(dataFlickr5$DateTaken, 1, 4)
  dataFlickr5$Month <- substr(dataFlickr5$DateTaken, 6, 7)
  dataFlickr5$Day <- substr(dataFlickr5$DateTaken, 9, 10)

  dataUnique <- dataFlickr5%>%group_by(owner, Year, Month, Day, LakeName)%>%summarise(Count = n())
  
  dataUnique <- dataUnique%>%filter(Year != 2018)

  dataVPY <- dataUnique%>%group_by(LakeName)%>%summarise(VPY = n() / 5)
  
  return(dataVPY)
}
```


*need to use the bbox for everything on flickr*


Actually pulling lake visitor data from flickr now
===

### Lake Mendota

For these I want the output to be just one table of all of the photos, then attach Lake = Lake Mendota for a column and leave it as that

```{r}
mendotaFlickr5 <- GetPhotosBBox(query = "Lake Mendota", startDate = "5/24/2015", bbox = "-90,43,-89,44")
dim(mendotaFlickr5)
mendotaFlickr5$DateTaken <- sapply(mendotaFlickr5$id, GetDate)
mendotaFlickr5 

# mendota1.1.2013_5.23.2015 <- mendotaFlickr5
# mendota5.24.2015_2018 <- mendotaFlickr5

mendotaFlickr5 <- rbind(mendota1.1.2013_5.23.2015, mendota5.24.2015_2018)
mendotaFlickr5$LakeName <- "LAKE MENDOTA"
```

### Lake Onalaska

```{r}
onalaskaFlickr5 <- GetPhotosBBox(query = "Lake Onalaska", startDate = "1/1/2013", bbox = "-92,43,-91,44")
dim(onalaskaFlickr5)
onalaskaFlickr5$DateTaken <- sapply(onalaskaFlickr5$id, GetDate)
onalaskaFlickr5
onalaskaFlickr5$LakeName <- "LAKE ONALASKA"
```

### Lake Eau Galle

```{r}
eaugalleFlickr5 <- GetPhotosBBox(query = "Lake Eau Galle", startDate = "8/3/2014", bbox = "-92.5,44,-91.5,45")
dim(eaugalleFlickr5)
eaugalleFlickr5$DateTaken <- sapply(eaugalleFlickr5$id, GetDate)
eaugalleFlickr5

##eaugalle1.1.2013_4.8.2014 <- eaugalleFlickr5
##eaugalle4.9.2014_8.2.2014 <- eaugalleFlickr5

eaugalleFlickr5 <- rbind(eaugalle1.1.2013_4.8.2014, eaugalle4.9.2014_8.2.2014)
eaugalleFlickr5$LakeName <- "LAKE EAU GALLE"
```

### Shawano Lake

```{r}
shawanoFlickr5 <- GetPhotosBBox(query = "Shawano Lake", startDate = "6/6/2016", bbox = "-89,44,-88,45")
dim(shawanoFlickr5)
shawanoFlickr5$DateTaken <- sapply(shawanoFlickr5$id, GetDate)
shawanoFlickr5

##shawano1.1.2013_2.1.2015 <- shawanoFlickr5
##shawano2.2.2015_6.5.2016 <- shawanoFlickr5

shawanoFlickr5 <- rbind(shawano1.1.2013_2.1.2015, shawano2.2.2015_6.5.2016)
shawanoFlickr5$LakeName <- "SHAWANO LAKE"
```

### Lake Waubesa

```{r}
waubesaFlickr5 <- GetPhotosBBox(query = "Lake Waubesa", startDate = "1/1/2013", bbox = "-90,43,-89,44")
dim(waubesaFlickr5)
waubesaFlickr5$DateTaken <- sapply(waubesaFlickr5$id, GetDate)
waubesaFlickr5
waubesaFlickr5$LakeName <- "LAKE WAUBESA"
```

### Druid Lake

```{r}
druidFlickr5 <- GetPhotosBBox(query = "Druid Lake", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(druidFlickr5) ## no photos
```

### Hatch Lake

```{r}
hatchFlickr5 <- GetPhotosBBox(query = "Hatch Lake", startDate = "1/1/2013", bbox = "-90,44,-89,45")
dim(hatchFlickr5) ## no photos
```

### Willow Flowage

```{r}
willowFlickr5 <- GetPhotosBBox(query = "Willow Flowage", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(willowFlickr5)
willowFlickr5$DateTaken <- sapply(willowFlickr5$id, GetDate)
willowFlickr5
willowFlickr5$LakeName <- "WILLOW FLOWAGE"
```

### Squash Lake

```{r}
squashFlickr5 <- GetPhotosBBox(query = "Squash Lake", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(squashFlickr5) ## no photos
```

### McGee Lake

```{r}
mcgeeFlickr5 <- GetPhotosBBox(query = "McGee Lake", startDate = "1/1/2013", bbox = "-89,45,-98,46")
dim(mcgeeFlickr5) ## no photos
```

### Towanda Lake

```{r}
towandaFlickr5 <- GetPhotosBBox(query = "Towanda Lake", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(towandaFlickr5) ## no photos
```

### Tabor Lake

```{r}
taborFlickr5 <- GetPhotosBBox(query = "Tabor Lake", startDate = "1/1/2013", bbox = "-93,46,-92,47")
dim(taborFlickr5) ## no photos
```

### Ludden Lake

```{r}
luddenFlickr5 <- GetPhotosBBox(query = "Ludden Lake", startDate = "1/1/2013", bbox = "-91,42,-90,43")
dim(luddenFlickr5) ## no photos
```

### Rice River Flowage

```{r}
riceriver <- GetPhotosBBox(query = "Rice River Flowage", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(riceriver) ## no photos
```

### Hulls Lake

```{r}
hullsFlickr5 <- GetPhotosBBox(query = "Hulls Lake", startDate = "1/1/2013", bbox = "-91,45,-90,46")
dim(hullsFlickr5) ## no photos
```

### Big Portage Lake

```{r}
bigportageFlickr5 <- GetPhotosBBox(query = "Big Portage Lake", startDate = "1/1/2013", bbox = "-90,46,-89,47")
dim(bigportageFlickr5)
bigportageFlickr5$DateTaken <- sapply(bigportageFlickr5$id, GetDate)
bigportageFlickr5
bigportageFlickr5$LakeName <- "BIG PORTAGE LAKE"
```

### Lake Owen

```{r}
owenFlickr5 <- GetPhotosBBox(query = "Lake Owen", startDate = "1/1/2013", bbox = "-92,46,-91,47")
dim(owenFlickr5)
owenFlickr5$DateTaken <- sapply(owenFlickr5$id, GetDate)
owenFlickr5
owenFlickr5$LakeName <- "LAKE OWEN"
```

### Big Eau Pleine Resevoir

```{r}
bigeaupleineFlickr5 <- GetPhotosBBox(query = "Big Eau Pleine Resevoir", startDate = "1/1/2013", bbox = "-90,44,-89,47")
dim(bigeaupleineFlickr5) ## no photos
```

### Parker Lake

```{r}
parkerFlickr5 <- GetPhotosBBox(query = "Parker Lake", startDate = "1/1/2013", bbox = "-90,43,-89,44")
dim(parkerFlickr5) ## no photos
```

### Shell Lake

```{r}
shellFlickr5 <- GetPhotosBBox(query = "Shell Lake", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(shellFlickr5)
shellFlickr5$DateTaken <- sapply(shellFlickr5$id, GetDate)
shellFlickr5
shellFlickr5$LakeName <- "SHELL LAKE"
```

### Lake Koshkonong

```{r}
koshkonongFlickr5 <- GetPhotosBBox(query = "Lake Koshkonong", startDate = "1/1/2013", bbox = "-89,42,-88,43")
dim(koshkonongFlickr5) 
koshkonongFlickr5$DateTaken <- sapply(koshkonongFlickr5$id, GetDate)
koshkonongFlickr5
koshkonongFlickr5$LakeName <- "LAKE KOSHKONONG"
```

### Lake Ripley

```{r}
ripleyFlickr5 <- GetPhotosBBox(query = "Lake Ripley", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(ripleyFlickr5)
ripleyFlickr5$DateTaken <- sapply(ripleyFlickr5$id, GetDate)
ripleyFlickr5
ripleyFlickr5$LakeName <- "LAKE RIPLEY"
```

### Nagawicka Lake

```{r}
nagawickaFlickr5 <- GetPhotosBBox(query = "Nagawicka Lake", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(nagawickaFlickr5)
nagawickaFlickr5$DateTaken <- sapply(nagawickaFlickr5$id, GetDate)
nagawickaFlickr5
nagawickaFlickr5$LakeName <- "NAGAWICKA LAKE"
```

### Birch Lake

```{r}
birchFlickr5 <- GetPhotosBBox(query = "Birch Lake", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(birchFlickr5) ## no photos
```


### Green Lake

```{r}
greenFlickr5 <- GetPhotosBBox(query = "Green Lake", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(greenFlickr5)
greenFlickr5$DateTaken <- sapply(greenFlickr5$id, GetDate)
greenFlickr5
greenFlickr5$LakeName <- "GREEN LAKE"
```

### Beaver Dam Lake

```{r}
beaverdamFlickr5 <- GetPhotosBBox(query = "Beaver Dam Lake", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(beaverdamFlickr5)
beaverdamFlickr5$DateTaken <- sapply(beaverdamFlickr5$id, GetDate)
beaverdamFlickr5
beaverdamFlickr5$LakeName <- "BEAVER DAM LAKE"
```

### Lac Courte Oreilles

```{r}
laccourteFlickr5 <- GetPhotosBBox(query = "Lac Courte Oreilles", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(laccourteFlickr5)
laccourteFlickr5$DateTaken <- sapply(laccourteFlickr5$id, GetDate)
laccourteFlickr5
laccourteFlickr5$LakeName <- "LAC COURTE OREILLES"
```

### Puckaway Lake

```{r}
puckawayFlickr5 <- GetPhotosBBox(query = "Puckaway Lake", startDate = "1/1/2013", bbox = "-90,43,-89,44")
dim(puckawayFlickr5)
puckawayFlickr5$DateTaken <- sapply(puckawayFlickr5$id, GetDate)
puckawayFlickr5
puckawayFlickr5$LakeName <- "PUCKAWAY LAKE"
```

### Trout Lake

```{r}
troutFlickr5 <- GetPhotosBBox(query = "Trout Lake", startDate = "1/1/2013", bbox = "-90,46,-89,47")
dim(troutFlickr5)
troutFlickr5$DateTaken <- sapply(troutFlickr5$id, GetDate)
troutFlickr5
troutFlickr5$LakeName <- "TROUT LAKE"
```

### Tomahawk Lake

```{r}
tomahawkFlickr5 <- GetPhotosBBox(query = "Tomahawk Lake", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(tomahawkFlickr5)
tomahawkFlickr5$DateTaken <- sapply(tomahawkFlickr5$id, GetDate)
tomahawkFlickr5
tomahawkFlickr5$LakeName <- "TOMAHAWK LAKE"
```

### Long Lake

```{r}
longFlickr5 <- GetPhotosBBox(query = "Long Lake", startDate = "1/1/2013", bbox = "-89,45,-90,46")
dim(longFlickr5) ## no photos
```

### Lake Monona

```{r}
mononaFlickr5 <- GetPhotosBBox(query = "Lake Monona", startDate = "1/1/2013", bbox = "-90,43,-89,44")
dim(mononaFlickr5)
mononaFlickr5$DateTaken <- sapply(mononaFlickr5$id, GetDate)
mononaFlickr5
mononaFlickr5$LakeName <- "LAKE MONONA"
```

### Namekagon Lake

```{r}
namekagonFlickr5 <- GetPhotosBBox(query = "Namekagon Lake", startDate = "1/1/2013", bbox = "-92,46,-91,47")
dim(namekagonFlickr5)
namekagonFlickr5$DateTaken <- sapply(namekagonFlickr5$id, GetDate)
namekagonFlickr5
namekagonFlickr5$LakeName <- "NAMEKAGON LAKE"
```

### Lake Kegonsa

```{r}
kegonsaFlickr5 <- GetPhotosBBox(query = "Lake Kegonsa", startDate = "1/1/2013", bbox = "-90,42,-89,43")
dim(kegonsaFlickr5)
kegonsaFlickr5$DateTaken <- sapply(kegonsaFlickr5$id, GetDate)
kegonsaFlickr5
kegonsaFlickr5$LakeName <- "LAKE KEGONSA"
```

### Grindstone Lake

```{r}
grindstoneFlickr5 <- GetPhotosBBox(query = "Grindstone Lake", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(grindstoneFlickr5) ## no photos
```

### Nelson Lake

```{r}
nelsonFlickr5 <- GetPhotosBBox(query = "Nelson Lake", startDate = "1/1/2013", bbox = "-92,46,-91,47")
dim(nelsonFlickr5) ## no photos
```

### Fox Lake

```{r}
foxFlickr5 <- GetPhotosBBox(query = "Fox Lake", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(foxFlickr5)
foxFlickr5$DateTaken <- sapply(foxFlickr5$id, GetDate)
foxFlickr5
foxFlickr5$LakeName <- "FOX LAKE"
```

### Lake Noquebay

```{r}
noquebayFlickr5 <- GetPhotosBBox(query = "Lake Noquebay", startDate = "1/1/2013", bbox = "-88,45,-87,46")
dim(noquebayFlickr5) ## no photos
```

### Pewaukee Lake

```{r}
pewaukeeFlickr5 <- GetPhotosBBox(query = "Pewaukee Lake", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(pewaukeeFlickr5)
pewaukeeFlickr5$DateTaken <- sapply(pewaukeeFlickr5$id, GetDate)
pewaukeeFlickr5
pewaukeeFlickr5$LakeName <- "PEWAUKEE LAKE"
```

### Lake Chetac

```{r}
chetacFlickr5 <- GetPhotosBBox(query = "Lake Chetac", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(chetacFlickr5)
chetacFlickr5$DateTaken <- sapply(chetacFlickr5$id, GetDate)
chetacFlickr5
chetacFlickr5$LakeName <- "LAKE CHETAC"
```

### Teal Lake

```{r}
tealFlickr5 <- GetPhotosBBox(query = "Teal Lake", startDate = "1/1/2013", bbox = "-92,46,-91,47")
dim(tealFlickr5)
tealFlickr5$DateTaken <- sapply(tealFlickr5$id, GetDate)
tealFlickr5 ##only in 2018 so no photos that we care about

```

### Yellow Lake

```{r}
yellowFlickr5 <- GetPhotosBBox(query = "Yellow Lake", startDate = "1/1/2013", bbox = "-93,45,-92,46")
dim(yellowFlickr5)
yellowFlickr5$DateTaken <- sapply(yellowFlickr5$id, GetDate)
yellowFlickr5
yellowFlickr5$LakeName <- "YELLOW LAKE"
```

### Red Cedar Lake

```{r}
redcedarFlickr5 <- GetPhotosBBox(query = "Red Cedar Lake", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(redcedarFlickr5)
redcedarFlickr5$DateTaken <- sapply(redcedarFlickr5$id, GetDate)
redcedarFlickr5
redcedarFlickr5$LakeName <- "RED CEDAR LAKE"
```


### Metonga Lake

```{r}
metongaFlickr5 <- GetPhotosBBox(query = "Metonga Lake", startDate = "1/1/2013", bbox = "-89,45,-90,46")
dim(metongaFlickr5) ## no photos
```

### Lake Mohawksin

```{r}
mohawksinFlickr5 <- GetPhotosBBox(query = "Lake Mohawksin", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(mohawksinFlickr5)
mohawksinFlickr5$DateTaken <- sapply(mohawksinFlickr5$id, GetDate)
mohawksinFlickr5
mohawksinFlickr5$LakeName <- "LAKE MOHAWKSIN"
```

### Eagle Lake

```{r}
eagleFlickr5 <- GetPhotosBBox(query = "Eagle Lake", startDate = "1/1/2013", bbox = "-89,42,-88,43")
dim(eagleFlickr5)
eagleFlickr5$DateTaken <- sapply(eagleFlickr5$id, GetDate)
eagleFlickr5
eagleFlickr5$LakeName <- "EAGLE LAKE"
```

### Delevan Lake

```{r}
delevanFlickr5 <- GetPhotosBBox(query = "Delevan Lake", startDate = "1/1/2013", bbox = "-89,42,-88,43")
dim(delevanFlickr5)
delevanFlickr5$DateTaken <- sapply(delevanFlickr5$id, GetDate)
delevanFlickr5 ## just 2018 so no photos
```

### Minong Flowage

```{r}
minongFlickr5 <- GetPhotosBBox(query = "Minong Flowage", startDate = "1/1/2013", bbox = "-92,46,-91,47")
dim(minongFlickr5)
minongFlickr5$DateTaken <- sapply(minongFlickr5$id, GetDate)
minongFlickr5
minongFlickr5$LakeName <- "MINONG FLOWAGE"
```

### Bone Lake

```{r}
boneFlickr5 <- GetPhotosBBox(query = "Bone Lake", startDate = "1/1/2013", bbox = "-93,45,-92,46")
dim(boneFlickr5)
boneFlickr5$DateTaken <- sapply(boneFlickr5$id, GetDate)
boneFlickr5
boneFlickr5$LakeName <- "BONE LAKE"
```

### Moose Lake

```{r}
mooseFlickr5 <- GetPhotosBBox(query = "Moose Lake", startDate = "1/1/2013", bbox = "-92,46,-91,47")
dim(mooseFlickr5) ## no photos
```

### High Falls Resevoir

```{r}
highfallsFlickr5 <- GetPhotosBBox(query = "High Falls Resevoir", startDate = "1/1/2013", bbox = "-89,45,-90,46")
dim(highfallsFlickr5) ## no photos
```

### Spider Lake

```{r}
spiderFlickr5 <- GetPhotosBBox(query = "Spider Lake", startDate = "1/1/2013", bbox = "-92,46,-91,47")
dim(spiderFlickr5) ## no photos
```

### Prairie Lake

```{r}
prairieFlickr5 <- GetPhotosBBox(query = "Prairie Lake", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(prairieFlickr5)
prairieFlickr5$DateTaken <- sapply(prairieFlickr5$id, GetDate)
prairieFlickr5
prairieFlickr5$LakeName <- "PRAIRIE LAKE"
```

### Tainter Lake

```{r}
tainterFlickr5 <- GetPhotosBBox(query = "Tainter Lake", startDate = "1/1/2013", bbox = "-92,44,-91,45")
dim(tainterFlickr5) ## no photos
```

### Rock Lake

```{r}
rockFlickr5 <- GetPhotosBBox(query = "Rock Lake", startDate = "1/1/2013", bbox = "-89,43,-88,44")
dim(rockFlickr5)
rockFlickr5$DateTaken <- sapply(rockFlickr5$id, GetDate)
rockFlickr5
rockFlickr5$LakeName <- "ROCK LAKE"
```

### Bear Lake

```{r}
bearFlickr5 <- GetPhotosBBox(query = "Bear Lake", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(bearFlickr5)
bearFlickr5$DateTaken <- sapply(bearFlickr5$id, GetDate)
bearFlickr5
bearFlickr5$LakeName <- "BEAR LAKE"
```

### Minocqua Lake

```{r}
minocquaFlickr5 <- GetPhotosBBox(query = "Minocqua Lake", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(minocquaFlickr5)
minocquaFlickr5$DateTaken <- sapply(minocquaFlickr5$id, GetDate)
minocquaFlickr5
minocquaFlickr5$LakeName <- "MINOCQUA LAKE"
```

### Clam Lake

```{r}
clamFlickr5 <- GetPhotosBBox(query = "Clam Lake", startDate = "1/1/2013", bbox = "-91,46,-90,47")
dim(clamFlickr5)
clamFlickr5$DateTaken <- sapply(clamFlickr5$id, GetDate)
clamFlickr5
clamFlickr5$LakeName <- "CLAM LAKE"
```

### Pickerel Lake

```{r}
pickerelFlickr5 <- GetPhotosBBox(query = "Pickerel Lake", startDate = "1/1/2013", bbox = "-90,45,-89,46")
dim(pickerelFlickr5) ## no photos
```

### Island Lake

```{r}
islandFlickr5 <- GetPhotosBBox(query = "Island Lake", startDate = "1/1/2013", bbox = "-92,45,-91,46")
dim(islandFlickr5)
islandFlickr5$DateTaken <- sapply(islandFlickr5$id, GetDate)
islandFlickr5
islandFlickr5$LakeName <- "ISLAND LAKE"
```


*Will need to re-run all of this below once I get the data for all 60 lakes that we are now looking into*
Combine the lakes into one data set to get the visitors per year (VPY) stats
===

```{r}
combinedFlickr5 <- rbind(mendotaFlickr5, onalaskaFlickr5, eaugalleFlickr5, shawanoFlickr5, waubesaFlickr5, willowFlickr5, bigportageFlickr5, owenFlickr5, shellFlickr5, koshkonongFlickr5, ripleyFlickr5, nagawickaFlickr5, greenFlickr5, beaverdamFlickr5, laccourteFlickr5, puckawayFlickr5, mononaFlickr5, namekagonFlickr5, kegonsaFlickr5, foxFlickr5, pewaukeeFlickr5, chetacFlickr5, yellowFlickr5, redcedarFlickr5, mohawksinFlickr5, eagleFlickr5, minongFlickr5, boneFlickr5, prairieFlickr5, rockFlickr5, bearFlickr5, minocquaFlickr5, clamFlickr5, islandFlickr5)

combinedFlickr5
```

Get VPY for these lakes
===

```{r}
vpyDF <- FlickrVPY(combinedFlickr5)
vpyDF

##now add on the 0 VPY for the rest of the lake
noPhotos <- data.frame(LakeName = c("DRUID LAKE", "HATCH LAKE", "SQUASH LAKE", "MCGEE LAKE", "TOWANDA LAKE", "TABOR LAKE", "LUDDEN LAKE", "RICE RIVER FLOWAGE", "HULLS LAKE", "BIG EAU PLEINE RESEVOIR", "PARKER LAKE", "BIRCH LAKE", "LONG LAKE", "GRINDSTONE LAKE", "NELSON LAKE", "LAKE NOQUEBAY", "TEAL LAKE", "METONGA LAKE", "DELEVAN LAKE", "MOOSE LAKE", "HIGH FALLS RESEVOIR", "SPIDER LAKE", "TAINTER LAKE", "PICKEREL LAKE"), VPY = rep(0,24))
noPhotos

##then combine the two data frames
vpyDF <- rbind(vpyDF, noPhotos)

##create a binary visitors or not column
vpyDF$HadVisitors <- vpyDF$VPY != 0
summary(vpyDF)
```

### Part 2

Lake Winnebago - *FAILED* not enough visitors
===

```{r}
winnebagoFlickr5 <- GetPhotosBBox(query = "Lake Winnebago", startDate = "1/1/2013", bbox = "-89,43,-88,44.4")
dim(winnebagoFlickr5)
winnebagoFlickr5$DateTake <- sapply(winnebagoFlickr5$id, GetDate)
winnebagoFlickr5 ##only 239 total photos so probably going to be a dead end

FlickrVPY(winnebagoFlickr5) ##18.8 VPY
```

Crater Lake - Looks very promising
===

```{r}
craterFlickr5 <- GetPhotosBBox(query = "Crater Lake", startDate = "1/1/2013", bbox = "-123,42,-122,43")
dim(craterFlickr5)
craterFlickr5$DateTaken <- sapply(craterFlickr5$id, GetDate)
craterFlickr5


#crater1.1.13_5.30.13 <- craterFlickr5
#crater5.31.13_7.17.13 <- craterFlickr5
##crater7.18.13_1.25.14 <- craterFlickr5
#crater1.26.14_5.20.14 <- craterFlickr5
#crater5.21.14_7.5.14 <- craterFlickr5
#crater7.6.14_8.18.14 <- craterFlickr5
#crater8.19.14_10.3.14 <- craterFlickr5
#crater10.4.14_6.12.15 <- craterFlickr5
#crater6.13.15_7.15.15 <- craterFlickr5

#crater7.16.15_8.9.15 <- craterFlickr5
#crater8.10.15_10.16.15 <- craterFlickr5
#crater10.17.15_6.13.16 <- craterFlickr5
#crater6.14.16_6.29.16 <- craterFlickr5
#crater6.30.16_7.31.16 <- craterFlickr5
#crater8.1.16_1.16.17 <- craterFlickr5
#crater1.17.17_6.13.17 <- craterFlickr5
##crater6.14.17_8.18.17 <- craterFlickr5
##crater8.19.17_6.30.18 <- craterFlickr5

craterFlickr5 <- rbind(crater1.1.13_5.30.13, crater5.31.13_7.17.13, crater7.18.13_1.25.14, crater1.26.14_5.20.14, crater5.21.14_7.5.14, crater7.6.14_8.18.14, crater8.19.14_10.3.14, crater10.4.14_6.12.15, crater6.13.15_7.15.15, crater7.16.15_8.9.15, crater8.10.15_10.16.15, crater10.17.15_6.13.16, crater6.14.16_6.29.16, crater6.30.16_7.31.16, crater8.1.16_1.16.17, crater1.17.17_6.13.17, crater6.14.17_8.18.17, crater8.19.17_6.30.18)

dim(craterFlickr5)
```

Crater Lake Unique / Monthly / Yearly
===

```{r}
craterFlickr5$Year <- substr(craterFlickr5$DateTaken, 1, 4)
craterFlickr5$Month <- substr(craterFlickr5$DateTaken, 6, 7)
craterFlickr5$Day <- substr(craterFlickr5$DateTaken, 9, 10)

craterUnique <- craterFlickr5%>%group_by(owner, Year, Month, Day)%>%summarise(Count = n())
dim(craterUnique) ## 711 unique visitor days

##monthly data
craterMonth <- craterUnique%>%group_by(Year, Month)%>%summarise(Count = n())
craterMonth$Date <- paste(craterMonth$Year, craterMonth$Month, sep = "-")
craterMonth$Group = 1

ggplot(data = craterMonth, aes(x = Date, y = Count, group = Group, col = Year)) +
  geom_line(size = 2) +
  theme_bw() +
  scale_x_discrete(labels = c(rep(c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"), 5), "Jan", "Feb", "Mar", "Apr", "May", "Jun")) +
  theme(axis.text.x = element_text(angle = 90)) +
  scale_color_manual(values = c("red", "orange", "gold", "green", "blue", "purple")) +
  xlab("Month") +
  ylab("Number of Flickr Visitors") +
  ggtitle("Crater Lake Flickr Visitors Per Month") + 
  geom_smooth(se = F, method = "lm", col = "black")

##yearly data
craterYear <- craterUnique%>%group_by(Year)%>%summarise(Count = n())
craterYear$Group = 1

ggplot(data = craterYear[craterYear$Year != 2018,], aes(x = Year, y = Count, group = Group)) + geom_line()
```

Lake Mendota and Crater Lake Flickr to make for the bot ==> *next pull on 7/16/18*
===

### Lake Mendota

```{r}
mendotaTweets7.6.18 <- search_tweets(q = "Lake Mendota", n = 18000, include_rts = F)
ts_plot(mendotaTweets7.6.18)
mendotaTweets7.6.18

save(mendotaTweets7.6.18, file = "medotaTweets7.6.18.rda")
```

### Crater Lake

```{r}
craterTweets7.6.18 <- search_tweets(q = "Crater Lake", n = 18000, include_rts = F)
ts_plot(craterTweets7.6.18)
craterTweets7.6.18

save(craterTweets7.6.18, file = "craterTweets7.6.18.rda")
```


Function To Make the visitors per month with zeros included
===

```{r}
## This function will take the raw flickr posts data and will return a data frame containing the number of visitors per month
## Inputs: raw flickr data for the past 5 years
## Outputs: summary of the number of visitors per month
GetVPM <- function(dataFlickr5) {
  dataFlickr5$Year <- substr(dataFlickr5$DateTaken, 1, 4)
  dataFlickr5$Month <- substr(dataFlickr5$DateTaken, 6, 7)
  dataFlickr5$Day <- substr(dataFlickr5$DateTaken, 9, 10)

  dataUnique <- dataFlickr5%>%group_by(owner, Year, Month, Day)%>%summarise(Count = n())

  dataMonth <- dataUnique%>%group_by(Year, Month)%>%summarise(Count = n())
  dataMonth$Date <- paste(dataMonth$Year, dataMonth$Month, sep = "-")
  dataMonth$Group <- 1
  
  dataMonth2 <- DATES%>%left_join(dataMonth[,-c(1,2)], by = "Date")
  dataMonth2$Count[is.na(dataMonth2$Count)] <- 0
  dataMonth2$Group <- 1
  
  return(dataMonth2)
}
```


Governer Dodge State Park
===

```{r}
dodgeFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-90.134575,42.994764,-90.077606,43.055694")
dim(dodgeFlickr5)
dodgeFlickr5$DateTaken <- sapply(dodgeFlickr5$id, GetDate)
dodgeFlickr5##This is all the photos from Governer Dodge State Park
dodgeFlickr5$Name <- "Governer Dodge State Park, WI"

dodgeMonth <- GetVPM(dodgeFlickr5)
dodgeMonth

dodgeVisitors <- read.csv("governerDodgeVisitors.csv", header = T)
dodgeVisitors$Month <- as.character(dodgeVisitors$Month)
dodgeVisitors$Year <- as.character(dodgeVisitors$Year)

for (i in 1:nrow(dodgeVisitors)) {
  if (nchar(dodgeVisitors$Month[i]) == 1) {
    dodgeVisitors$Month[i] <- paste("0", dodgeVisitors$Month[i], sep = "")
  }
}

dodgeMonth <- dodgeMonth%>%left_join(dodgeVisitors, by = c("Year", "Month"))
dodgeMonth$Dist <- 4.38
```

Lake Kegonsa State Park
===

```{r}
kegonsaFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-89.282692,42.946872,-89.220319,42.98512")
dim(kegonsaFlickr5) ##only 105 photos total
kegonsaFlickr5$DateTaken <- sapply(kegonsaFlickr5$id, GetDate)
kegonsaFlickr5
kegonsaFlickr5$Name <- "Lake Kegonsa State Park, WI"

kegonsaMonth <- GetVPM(kegonsaFlickr5)
kegonsaMonth

kegonsaVisitors <- read.csv("kegonsaVisitors.csv", header = T)
kegonsaVisitors$Month <- as.character(kegonsaVisitors$Month)
kegonsaVisitors$Year <- as.character(kegonsaVisitors$Year)

for (i in 1:nrow(kegonsaVisitors)) {
  if (nchar(kegonsaVisitors$Month[i]) == 1) {
    kegonsaVisitors$Month[i] <- paste("0", kegonsaVisitors$Month[i], sep = "")
  }
}

kegonsaMonth <- kegonsaMonth%>%left_join(kegonsaVisitors, by = c("Year", "Month"))
kegonsaMonth$Dist <- 4.06 
```

Yellowstone Lake State Park
===

```{r}
yellowstoneFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-90.043154,42.747275,-89.950532,42.788051")
dim(yellowstoneFlickr5) ##only 110 photos
yellowstoneFlickr5$DateTaken <- sapply(yellowstoneFlickr5$id, GetDate)
yellowstoneFlickr5
yellowstoneFlickr5$Name <- "Yellowstone Lake State Park, WI"

yellowstoneMonth <- GetVPM(yellowstoneFlickr5)
yellowstoneMonth

yellowstoneVisitors <- read.csv("yellowstoneVisitors.csv", header = T)
yellowstoneVisitors$Month <- as.character(yellowstoneVisitors$Month)
yellowstoneVisitors$Year <- as.character(yellowstoneVisitors$Year)

for (i in 1:nrow(yellowstoneVisitors)) {
  if (nchar(yellowstoneVisitors$Month[i]) == 1) {
    yellowstoneVisitors$Month[i] <- paste("0", yellowstoneVisitors$Month[i], sep = "")
  }
}

yellowstoneMonth <- yellowstoneMonth%>%left_join(yellowstoneVisitors, by = c("Year", "Month"))
yellowstoneMonth$Dist <- 6.70
```

Big Foot Beach State Park (on Geneva Lake)
===

```{r}
bigfootFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-88.46464,42.565459,-88.412035,42.573933")
dim(bigfootFlickr5) ##only 31 photos
bigfootFlickr5$DateTaken <- sapply(bigfootFlickr5$id, GetDate)
bigfootFlickr5
bigfootFlickr5$Name <- "Big Foot Lake State Park, WI"

bigfootMonth <- GetVPM(bigfootFlickr5)
bigfootMonth

bigfootVisitors <- read.csv("bigfootVisitors.csv", header = T)
bigfootVisitors$Month <- as.character(bigfootVisitors$Month)
bigfootVisitors$Year <- as.character(bigfootVisitors$Year)

for (i in 1:nrow(bigfootVisitors)) {
  if (nchar(bigfootVisitors$Month[i]) == 1) {
    bigfootVisitors$Month[i] <- paste("0", bigfootVisitors$Month[i], sep = "")
  }
}

bigfootMonth <- bigfootMonth%>%left_join(bigfootVisitors, by = c("Year", "Month"))
bigfootMonth$Dist <- 1.80
```

Mirror Lake State Park (by the dells)
===

```{r}
mirrorFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-89.846896,43.548288,-89.790738,43.580801")
dim(mirrorFlickr5) ##only 122 photos
mirrorFlickr5$DateTaken <- sapply(mirrorFlickr5$id, GetDate)
mirrorFlickr5
mirrorFlickr5$Name <- "Mirror Lake State Park, WI"

mirrorMonth <- GetVPM(mirrorFlickr5)
mirrorMonth

mirrorVisitors <- read.csv("mirrorVisitors.csv", header = T)
mirrorVisitors$Month <- as.character(mirrorVisitors$Month)
mirrorVisitors$Year <- as.character(mirrorVisitors$Year)

for (i in 1:nrow(mirrorVisitors)) {
  if (nchar(mirrorVisitors$Month[i]) == 1) {
    mirrorVisitors$Month[i] <- paste("0", mirrorVisitors$Month[i], sep = "")
  }
}

mirrorMonth <- mirrorMonth%>%left_join(mirrorVisitors, by = c("Year", "Month"))
mirrorMonth$Dist <- 2.50
```

Penninsula State Park
===

```{r}
penninsulaFlickr5 <- GetPhotosBBox(query = "", startDate = "10/9/2017", bbox = "-87.249334,45.121876,-87.177923,45.175806")
dim(penninsulaFlickr5)
penninsulaFlickr5$DateTaken <- sapply(penninsulaFlickr5$id, GetDate)
penninsulaFlickr5
penninsulaFlickr5$Name <- "Penninsula State Park, WI"

#penninsula1.1.13_10.13.13 <- penninsulaFlickr5
#penninsula10.14.13_8.19.14 <- penninsulaFlickr5
#penninsula8.20.14_6.29.15 <- penninsulaFlickr5
#penninsula6.30.15_10.8.17 <- penninsulaFlickr5
#penninsula10.9.17_6.19.18 <- penninsulaFlickr5

penninsulaFlickr5 <- rbind(penninsula1.1.13_10.13.13, penninsula10.14.13_8.19.14, penninsula8.20.14_6.29.15, penninsula6.30.15_10.8.17, penninsula10.9.17_6.19.18)

dim(penninsulaFlickr5)

penninsulaMonth <- GetVPM(penninsulaFlickr5)
penninsulaMonth$Dist <- 2.31
```

Pattison State Park
===

```{r}
pattisonFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-92.145025,46.515907,-92.091446,46.555321")
dim(pattisonFlickr5) ##only 82 photos
pattisonFlickr5$DateTaken <- sapply(pattisonFlickr5$id, GetDate)
pattisonFlickr5
pattisonFlickr5$Name <- "Pattison State Park, WI"

pattisonMonth <- GetVPM(pattisonFlickr5)
pattisonMonth

pattisonVisitors <- read.csv("pattisonVisitors.csv", header = T)
pattisonVisitors$Month <- as.character(pattisonVisitors$Month)
pattisonVisitors$Year <- as.character(pattisonVisitors$Year)

for (i in 1:nrow(pattisonVisitors)) {
  if (nchar(pattisonVisitors$Month[i]) == 1) {
    pattisonVisitors$Month[i] <- paste("0", pattisonVisitors$Month[i], sep = "")
  }
}

pattisonMonth <- pattisonMonth%>%left_join(pattisonVisitors, by = c("Year", "Month"))
pattisonMonth$Dist <- 13.02
```

Buckhorn State Park
===

```{r}
buckhornFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-90.066141,43.861635,-89.91464,43.991167")
dim(buckhornFlickr5) ##only 34 photos
buckhornFlickr5$DateTaken <- sapply(buckhornFlickr5$id, GetDate)
buckhornFlickr5
buckhornFlickr5$Name <- "Buckhorn State Park, WI"

buckhornMonth <- GetVPM(buckhornFlickr5)
buckhornMonth

buckhornVisitors <- read.csv("buckhornVisitors.csv", header = T)
buckhornVisitors$Month <- as.character(buckhornVisitors$Month)
buckhornVisitors$Year <- as.character(buckhornVisitors$Year)

for (i in 1:nrow(buckhornVisitors)) {
  if (nchar(buckhornVisitors$Month[i]) == 1) {
    buckhornVisitors$Month[i] <- paste("0", buckhornVisitors$Month[i], sep = "")
  }
}

buckhornMonth <- buckhornMonth%>%left_join(buckhornVisitors, by = c("Year", "Month"))
buckhornMonth$Dist <- 6.58
```

Perrot State Park
===

```{r}
perrotFlickr5 <- GetPhotosBBox(query = "", startDate = "1/1/2013", bbox = "-91.57958,44.007819,-91.424588,44.072136")
dim(perrotFlickr5)
perrotFlickr5$DateTaken <- sapply(perrotFlickr5$id, GetDate)
perrotFlickr5
perrotFlickr5$Name <- "Perrot State Park, WI"

perrotMonth <- GetVPM(perrotFlickr5)
perrotMonth

perrotVisitors <- read.csv("perrotVisitors.csv", header = T)
perrotVisitors$Month <- as.character(perrotVisitors$Month)
perrotVisitors$Year <- as.character(perrotVisitors$Year)

for (i in 1:nrow(perrotVisitors)) {
  if (nchar(perrotVisitors$Month[i]) == 1) {
    perrotVisitors$Month[i] <- paste("0", perrotVisitors$Month[i], sep = "")
  }
}

perrotMonth <- perrotMonth%>%left_join(perrotVisitors, by = c("Year", "Month"))
perrotMonth$Dist <- 1.65
```

